# Мелкие рекомендации (backlog)

> **Обновлено:** 16.02.2026
> **Назначение:** Некритичные улучшения для будущей реализации

---

## Формат записи

```markdown
### N. Краткое описание проблемы
- **Файл:** `путь/к/файлу.ts:строка`
- **Суть:** Описание проблемы
- **Исправление:** Что нужно сделать
- **Источник:** Review (дата)
- **Статус:** Открыто / Готово
- **Приписка (при исправлении):** <ИмяАгента> (DD.MM.YYYY): Исправил. <Детали>
```

---

## P0 — Критические (требуют немедленного исправления)

### 1. TypeScript check упал — отсутствует поле `content` в NewsItem
- **Файлы:**
  - `src/lib/types.ts:1-12` (интерфейс)
  - `src/lib/server/db/news-repository.ts:67-68`
  - `src/lib/server/news-service.ts:73,137,148`
  - `src/lib/server/jobs/feed-fetcher.ts:94,257,265,301,307`
  - `src/lib/server/news-utils.test.ts:88-124`
- **Суть:** Интерфейс `NewsItem` не содержит поле `content`, но оно используется в БД, репозитории, сервисах и тестах. `npm run check` падает с 16 ошибками.
- **Исправление:** Добавить `content?: string` в интерфейс `NewsItem`
- **Источник:** Review 16.02.2026-15-03
- **Статус:** Готово ✅
- **Приписка (при исправлении):** Codex (16.02.2026): Добавил в `NewsItem` поля `content?: string` и `originalContent?: string`, синхронизировал тип с фактическим использованием в backend.

---

## P1 — Важные (перед Stage 5 Deploy)

### 2. news-service.ts помечен @deprecated, но активно используется
- **Файл:** `src/lib/server/sources/index.ts:7`
- **Суть:** Функция `createNewsSources()` помечена deprecated, но используется в `+page.server.ts` как fallback при недоступности БД
- **Исправление:** Убрать комментарий `@deprecated` или полностью удалить fallback
- **Источник:** Review 16.02.2026-15-03
- **Статус:** Готово ✅
- **Приписка (при исправлении):** Codex (16.02.2026): Убрал `@deprecated`, оставил fallback и уточнил комментарий.

### 3. Типы 'arxiv' и 'api' остались в NewsSource.type
- **Файл:** `src/lib/server/types.ts:26`
- **Суть:** После Stage 7 ArXiv и NewsData были удалены, но типы `'api'` и `'arxiv'` остались в интерфейсе
- **Исправление:** Обновить на `type: 'rss'` (или `'rss' | 'reddit'`, если Reddit планируется)
- **Источник:** Review 16.02.2026-15-03
- **Статус:** Готово ✅
- **Приписка (при исправлении):** Codex (16.02.2026): Обновил `NewsSource.type` до `type: 'rss'`.

### 4. Тип 'reddit' объявлен, но Reddit-источник не реализован
- **Файл:** `src/lib/server/types.ts:26`
- **Суть:** В `NewsSource.type` есть `'reddit'`, но Reddit-источника нет в коде
- **Исправление:** Если Reddit не планируется — убрать из типов
- **Источник:** Review 16.02.2026-15-03
- **Статус:** Готово ✅
- **Приписка (при исправлении):** Codex (16.02.2026): Удалил `'reddit'` из union-типа `NewsSource.type`.

### 5. Dead code — поля суммаризации в schema.ts не используются
- **Файл:** `src/lib/server/db/schema.ts:50-53`
- **Суть:** Поля `summary`, `isSummarized`, `summaryModel` не используются. Суммаризация не реализована
- **Исправление:** Удалить поля + создать миграцию, или обновить комментарий на "(future Stage)"
- **Источник:** Review 16.02.2026-15-03
- **Статус:** Готово ✅
- **Приписка (при исправлении):** Codex (16.02.2026): Оставил поля для будущей функциональности и обновил комментарий на `(future stage, пока не используется)`.

---

## P2 — Рекомендации (можно отложить)

### 6. imageUrl в schema.ts не используется после Stage 7
- **Файл:** `src/lib/server/db/schema.ts:43`
- **Суть:** После удаления изображений поле `imageUrl` осталось в БД, но нигде не используется
- **Исправление:** Удалить поле + миграция: `ALTER TABLE articles DROP COLUMN image_url;`
- **Источник:** Review 16.02.2026-15-03
- **Статус:** Готово ✅
- **Приписка (при исправлении):** Codex (16.02.2026): Удалил `imageUrl` из Drizzle-схемы и добавил миграцию `drizzle/0001_drop_articles_image_url.sql`.

### 7. Комментарий в schema.ts устарел
- **Файл:** `src/lib/server/db/schema.ts:20`
- **Суть:** Комментарий `// 'rss' | 'api' | 'arxiv'` не синхронизирован с реальностью
- **Исправление:** Обновить на `// 'rss'`
- **Источник:** Review 16.02.2026-15-03
- **Статус:** Готово ✅
- **Приписка (при исправлении):** Codex (16.02.2026): Обновил комментарий в `schema.ts` на `// 'rss'`.

### 8. createNewsSources() используется только в одном месте
- **Файл:** `src/lib/server/sources/index.ts:8`
- **Суть:** Функция экспортируется, но используется только в `news-service.ts` (fallback)
- **Исправление:** Оставить, если fallback важен. Связано с пунктом 2
- **Источник:** Review 16.02.2026-15-03
- **Статус:** Готово ✅
- **Приписка (при исправлении):** Codex (16.02.2026): Оставил экспорт осознанно; используется в fallback-пайплайне `news-service.ts`.

### 9. docs/archive/TECHNICAL_PLAN_ARCHIVE.md (53 KB)
- **Файл:** `docs/archive/TECHNICAL_PLAN_ARCHIVE.md`
- **Суть:** Большой архивный документ (53 КБ)
- **Исправление:** Удалить, если не нужен для истории
- **Источник:** Review 16.02.2026-15-03
- **Статус:** Готово ✅
- **Приписка (при исправлении):** Codex (16.02.2026): Удалил архивный файл из репозитория как неиспользуемый.

---

## Архив исправленных (Stage 1-7)

Предыдущие замечания (1-28) были исправлены после Stage 7 Overhaul.
Для истории см. `git log` или `docs/archive/`.

---

**Последнее обновление:** 16.02.2026 15:21
**Статус:** 0 P0, 0 P1, 0 P2 — всего 0 открытых задач
